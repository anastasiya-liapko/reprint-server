"use strict";$(function(){jQuery(function(e){e("#messageForm-phone").mask("+79999999999")});var a=["name","phone","email","message"],s={email:"Введите e-mail в формате default@mail.com",phone:"Введите номер телефона в формате +1234567890"},r=/\+7[0-9]{10}/,n=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,t=function(e){$("#messageFormValid-"+e.name).text(e.error),$("#messageForm-"+e.name).addClass("error")},m=function(e){$("#messageFormValid-send").text(""),$("#messageFormValid-"+e).text(""),$("#messageForm-"+e).removeClass("error")},o={},i={},c=function(t,e){if(i={},""===e)$.each(a,function(e,a){if(t===a)switch(t){case"phone":""===$("#messageForm-email").val()&&(i={name:t,error:"Введите один из контактов"});break;case"email":""===$("#messageForm-phone").val()&&(i={name:t,error:"Введите один из контактов"});break;default:i={name:t,error:"Это обязательное поле"}}});else switch(t){case"phone":i=r.test(e)?{}:{name:t,error:s[t]};break;case"email":i=n.test(e)?{}:{name:t,error:s[t]}}return i},l=function(){return!!grecaptcha.getResponse().length},h=function(e){$("form .submit").addClass("disabled"),$("form .submit").prop("disabled",!0)},u=function(e){var a,s,t=(a=$(e),s=!0,a.find("input").each(function(){o[$(this)[0].name]=$(this).val()}),a.find("textarea").each(function(){o[$(this)[0].name]=$(this).val()}),$.each(o,function(e,a){var t=c(e,a);0<Object.keys(t).length&&(s=!1)}),s);l()&&t?($("form .submit").removeClass("disabled"),$("form .submit").prop("disabled",!1)):h()};$("#messageForm input").on("change keyup blur",function(){m($(this).attr("name")),"phone"===$(this).attr("name")&&m("email"),"email"===$(this).attr("name")&&m("phone");var e=c($(this).attr("name"),$(this).val());0<Object.keys(e).length?(t(e),h()):u("#messageForm")}),$("#messageForm textarea").on("change keyup blur",function(){m($(this).attr("name"));var e=c($(this).attr("name"),$(this).val());0<Object.keys(e).length?(t(e),h()):u("#messageForm")}),window.recaptchaCallback2=function(){console.log("recaptcha callback2"),$("#recaptchaError").text(""),u("#messageForm")},$("#messageForm").submit(function(e){if(l()){var a={};$(this).find("input").each(function(){a[$(this)[0].name]=$(this).val()}),$(this).find("textarea").each(function(){a[$(this)[0].name]=$(this).val()}),$.ajax({type:"POST",url:"form.php",data:a}).done(function(e){$("#messageFormValid-send").text("Сообщение отправлено!");var a=jQuery.parseJSON(e);console.log(a),$("#messageForm")[0].reset()})}else $("#recaptchaError").text('* Вы не прошли проверку "Я не робот"');e.preventDefault()})});